-- database: ./dev.db

-- Use the â–· button in the top right corner to run the entire file.

SELECT * FROM _prisma_migrations;


DROP VIEW IF EXISTS "ProdutosMaisVendidos";
CREATE VIEW "ProdutosMaisVendidos" AS
SELECT
  vp.produtoId,
  p.Nome AS nome,
  p.unidadePesagem,
  CAST(SUM(vp.quantidade) AS INTEGER) AS total_vendido,
  CAST(SUM(vp.preco_produto_totaltotal) AS INTEGER) AS valor_total
FROM venda_produto vp
JOIN Produto p ON p.id = vp.produtoId
GROUP BY vp.produtoId;
